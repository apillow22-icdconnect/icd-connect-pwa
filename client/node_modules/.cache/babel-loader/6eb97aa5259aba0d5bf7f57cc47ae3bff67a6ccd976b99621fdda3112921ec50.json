{"ast":null,"code":"import _objectSpread from\"/Users/rosavargas/ICD/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";const TenantContext=/*#__PURE__*/createContext();export const useTenant=()=>{const context=useContext(TenantContext);if(!context){throw new Error('useTenant must be used within a TenantProvider');}return context;};export const TenantProvider=_ref=>{let{children}=_ref;const[tenant,setTenant]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{fetchTenantInfo();},[]);const fetchTenantInfo=async()=>{try{setLoading(true);const response=await axios.get('/api/tenants/current');setTenant(response.data);// Apply theme to document\napplyTheme(response.data.theme);}catch(error){console.log('Tenant fetch failed, using default tenant');// Use default tenant for demo\nconst defaultTenant={id:1,domain:'icdconnect.com',name:'ICD Connect',theme:{primaryColor:'#1976d2',secondaryColor:'#dc004e',companyName:'ICD Connect',tagline:'Smart Circle Management Platform'},features:{messaging:true,scheduling:true,training:true,tests:true,leaderboard:true,stars:true}};setTenant(defaultTenant);applyTheme(defaultTenant.theme);}finally{setLoading(false);}};const applyTheme=theme=>{// Apply CSS custom properties for theming\nconst root=document.documentElement;root.style.setProperty('--primary-color',theme.primaryColor);root.style.setProperty('--secondary-color',theme.secondaryColor);// Update document title\ndocument.title=theme.companyName||'ICD Connect';// Update favicon if provided\nif(theme.favicon){const favicon=document.querySelector('link[rel=\"icon\"]');if(favicon){favicon.href=theme.favicon;}}};const updateTenant=async updates=>{try{const response=await axios.put(\"/api/tenants/\".concat(tenant.id),updates);setTenant(response.data.tenant);// Re-apply theme if theme was updated\nif(updates.theme){applyTheme(response.data.tenant.theme);}return response.data;}catch(error){console.log('Tenant update failed, using local update');// For demo, update locally\nconst updatedTenant=_objectSpread(_objectSpread({},tenant),updates);setTenant(updatedTenant);if(updates.theme){applyTheme(updatedTenant.theme);}return{success:true};}};const isFeatureEnabled=featureName=>{if(!tenant)return true;// Default to enabled if tenant not loaded\nreturn tenant.features[featureName]!==false;};const getTheme=()=>{return(tenant===null||tenant===void 0?void 0:tenant.theme)||{primaryColor:'#1976d2',secondaryColor:'#dc004e',companyName:'ICD Connect',tagline:'Smart Circle Management Platform'};};const value={tenant,loading,error,updateTenant,isFeatureEnabled,getTheme,refreshTenant:fetchTenantInfo};return/*#__PURE__*/_jsx(TenantContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","axios","jsx","_jsx","TenantContext","useTenant","context","Error","TenantProvider","_ref","children","tenant","setTenant","loading","setLoading","error","setError","fetchTenantInfo","response","get","data","applyTheme","theme","console","log","defaultTenant","id","domain","name","primaryColor","secondaryColor","companyName","tagline","features","messaging","scheduling","training","tests","leaderboard","stars","root","document","documentElement","style","setProperty","title","favicon","querySelector","href","updateTenant","updates","put","concat","updatedTenant","_objectSpread","success","isFeatureEnabled","featureName","getTheme","value","refreshTenant","Provider"],"sources":["/Users/rosavargas/ICD/client/src/contexts/TenantContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst TenantContext = createContext();\n\nexport const useTenant = () => {\n  const context = useContext(TenantContext);\n  if (!context) {\n    throw new Error('useTenant must be used within a TenantProvider');\n  }\n  return context;\n};\n\nexport const TenantProvider = ({ children }) => {\n  const [tenant, setTenant] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    fetchTenantInfo();\n  }, []);\n\n  const fetchTenantInfo = async () => {\n    try {\n      setLoading(true);\n      const response = await axios.get('/api/tenants/current');\n      setTenant(response.data);\n      \n      // Apply theme to document\n      applyTheme(response.data.theme);\n    } catch (error) {\n      console.log('Tenant fetch failed, using default tenant');\n      // Use default tenant for demo\n      const defaultTenant = {\n        id: 1,\n        domain: 'icdconnect.com',\n        name: 'ICD Connect',\n        theme: {\n          primaryColor: '#1976d2',\n          secondaryColor: '#dc004e',\n          companyName: 'ICD Connect',\n          tagline: 'Smart Circle Management Platform'\n        },\n        features: {\n          messaging: true,\n          scheduling: true,\n          training: true,\n          tests: true,\n          leaderboard: true,\n          stars: true\n        }\n      };\n      setTenant(defaultTenant);\n      applyTheme(defaultTenant.theme);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const applyTheme = (theme) => {\n    // Apply CSS custom properties for theming\n    const root = document.documentElement;\n    root.style.setProperty('--primary-color', theme.primaryColor);\n    root.style.setProperty('--secondary-color', theme.secondaryColor);\n    \n    // Update document title\n    document.title = theme.companyName || 'ICD Connect';\n    \n    // Update favicon if provided\n    if (theme.favicon) {\n      const favicon = document.querySelector('link[rel=\"icon\"]');\n      if (favicon) {\n        favicon.href = theme.favicon;\n      }\n    }\n  };\n\n  const updateTenant = async (updates) => {\n    try {\n      const response = await axios.put(`/api/tenants/${tenant.id}`, updates);\n      setTenant(response.data.tenant);\n      \n      // Re-apply theme if theme was updated\n      if (updates.theme) {\n        applyTheme(response.data.tenant.theme);\n      }\n      \n      return response.data;\n    } catch (error) {\n      console.log('Tenant update failed, using local update');\n      // For demo, update locally\n      const updatedTenant = { ...tenant, ...updates };\n      setTenant(updatedTenant);\n      if (updates.theme) {\n        applyTheme(updatedTenant.theme);\n      }\n      return { success: true };\n    }\n  };\n\n  const isFeatureEnabled = (featureName) => {\n    if (!tenant) return true; // Default to enabled if tenant not loaded\n    return tenant.features[featureName] !== false;\n  };\n\n  const getTheme = () => {\n    return tenant?.theme || {\n      primaryColor: '#1976d2',\n      secondaryColor: '#dc004e',\n      companyName: 'ICD Connect',\n      tagline: 'Smart Circle Management Platform'\n    };\n  };\n\n  const value = {\n    tenant,\n    loading,\n    error,\n    updateTenant,\n    isFeatureEnabled,\n    getTheme,\n    refreshTenant: fetchTenantInfo\n  };\n\n  return (\n    <TenantContext.Provider value={value}>\n      {children}\n    </TenantContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}